<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.18.4">
    <title>Overview – coxir v0.8.0</title>
    <link rel="stylesheet" href="dist/app-480ffdc169.css" />
    
    <script src="dist/sidebar_items-e986aa0cbe.js"></script>
    
    
    
    
  </head>
  <body data-type="extras">
    <script>try { if(localStorage.getItem('night-mode')) document.body.className += ' night-mode'; } catch (e) { }</script>

<div class="main">
<button class="sidebar-button sidebar-toggle">
  <span class="icon-menu" aria-hidden="true"></span>
  <span class="sr-only">Toggle Sidebar</span>
</button>
<button class="sidebar-button night-mode-toggle">
  <span class="icon-theme" aria-hidden="true"></span>
  <span class="sr-only">Toggle Theme</span>
</button>
<section class="sidebar">

  
  <a href="overview.html" class="sidebar-projectLink">
    <div class="sidebar-projectDetails">
      <h1 class="sidebar-projectName">
        coxir
      </h1>
      <h2 class="sidebar-projectVersion">
        v0.8.0
      </h2>
    </div>
    
  </a>

  <form class="sidebar-search" action="search.html">
    <button type="submit" class="search-button">
      <span class="icon-search" aria-hidden="true"></span>
    </button>
    <input name="q" type="text" id="search-list" class="search-input" placeholder="Search" aria-label="Search" autocomplete="off" />
  </form>

  <ul class="sidebar-listNav">
    <li><a id="extras-list" href="#full-list">Pages</a></li>

    
      <li><a id="modules-list" href="#full-list">Modules</a></li>
    

    

    
  </ul>
  <div class="gradient"></div>
  <ul id="full-list" class="sidebar-fullList"></ul>
</section>

<section class="content">
  <div class="content-outer">
    <div id="content" class="content-inner">


<h1>Overview</h1>
<p>coxir is an Elixir wrapper for Discord based on
<a href="https://github.com/kraigie/nostrum">nostrum</a> and
<a href="https://github.com/cronokirby/alchemy">alchemy</a>.</p>
<h3 id="structure" class="section-heading">
  <a href="#structure" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Structure
</h3>

<p>coxir is planned out to be simple and intuitive
both on its internals and when it comes to user
interaction. As such, its structure is rather
straightforward and compact, schemed across multiple
modules as follows.</p>
<ul>
<li><p><a href="./Coxir.API.html">API</a> - allows for a direct
interaction with Discord’s API whilst keeping track
of all the ratelimits.</p>
</li>
<li><p><a href="./Coxir.Gateway.html">Gateway</a> - supervises all
the gateway workers and includes a few methods to
communicate with.</p>
</li>
<li><p>Structures - provide specific API calls depending
on the type of the represented Discord object.</p>
</li>
<li><p><a href="./Coxir.Voice.html">Voice</a> - responsible for
handling and supervising all the audio logic
behind voice channels.</p>
</li>
</ul>
<p>Behind the scenes, upon application start, per-shard
gateway workers are started. These are in charge of
receiving data from Discord and piping it through a
GenStage - which consists of two stages: a caching
stage carried out by <em>Middle</em> processes and a consuming
stage. The latter being left in charge of the user.</p>
<h3 id="usage" class="section-heading">
  <a href="#usage" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Usage
</h3>

<p>Currently there is no package published on Hex and
instead one must include coxir as follows.</p>
<pre><code class="elixir">defp deps do
  [{:coxir, git: &quot;https://github.com/satom99/coxir.git&quot;}]
end</code></pre>
<p>Once installed, coxir must be configured as follows.
The snippet must be added into <code class="inline">config/config.exs</code>.</p>
<pre><code class="elixir">config :coxir,
  token: &quot;&quot;,
  shards: 1, # optional
  ffmpeg: &quot;&quot; # optional</code></pre>
<p>Where <code class="inline">token</code> should be your bot’s token and <code class="inline">shards</code>
the number of shards your bot is to be run at. If this
latter param is not set, it will default to the value
provided by Discord.</p>
<p>Once these steps are completed, one may configure their
application to start a consumer automatically. Usually
this would be done by specifying a module as an application
<a href="https://hexdocs.pm/elixir/Application.html#module-application-module-callback">callback</a>
which starts a <a href="https://hexdocs.pm/elixir/Supervisor.html"><code class="inline">Supervisor</code></a>.</p>
<pre><code class="elixir">defmodule Example do
  use Application
  use Supervisor

  def start(_type, _args) do
    children = [
      worker(Consumer, [])
    ]
    options = [
      strategy: :one_for_one,
      name: __MODULE__
    ]
    Supervisor.start_link(children, options)
  end
end</code></pre>
<p>Consuming events from the GenStage is now the last
requirement, and may be done easily as follows.</p>
<pre><code class="elixir">defmodule Consumer do
  use Coxir

  def handle_event({:MESSAGE_CREATE, message}, state) do
    case message.content do
      &quot;ping!&quot; -&gt;
        Message.reply(message, &quot;pong!&quot;)
      _ -&gt;
        :ignore
    end
    {:ok, state}
  end

  def handle_event(_event, state) do
    {:ok, state}
  end
end</code></pre>
<p>Note that when <em>using</em> <a href="Coxir.html"><code class="inline">Coxir</code></a> aliases to all the
structures and other crucial modules are included.</p>
<p>One may as well define their own
<a href="https://github.com/satom99/coxir/blob/master/lib/coxir/stage/consumer.ex">Consumer</a>
and manually subscribe to the processes
returned by <code class="inline">Stage.middles()</code> - which effectively are
the last stage and responsible for caching data internally.</p>

      <footer class="footer">
        <p>
          <span class="line">
            Built using
            <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" rel="help" target="_blank">ExDoc</a> (v0.18.4),
          </span>
          <span class="line">
            designed by
            <a href="https://twitter.com/dignifiedquire" target="_blank" title="@dignifiedquire">Friedel Ziegelmayer</a>.
            </span>
        </p>
      </footer>
    </div>
  </div>
</section>
</div>
  <script src="dist/app-9bd040e5e5.js"></script>
  
  
  
  
  </body>
</html>

